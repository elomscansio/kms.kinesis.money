var Le=Object.defineProperty;var Ne=(e,a,n)=>a in e?Le(e,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[a]=n;var Z=(e,a,n)=>Ne(e,typeof a!="symbol"?a+"":a,n);import{j as D,eV as _e,af as $e,ab as Ke,aw as q,r as d,bg as Re,e as Me,ax as ze,fm as We,b1 as y,d as T,fn as Ge,F as we,bv as ve,b$ as xe,a$ as He,df as qe,n as Qe,I as be,N as Ye,ev as Ze,fk as Je,bE as Xe,c as et,f8 as tt,f6 as at,dk as nt,fo as rt,fp as ot,t as pe,w as G,R as Ae,C as st,c7 as it,P as ke}from"./index-B1IYvx0M.js";import{N as ut}from"./react-number-format.es-D6j4F3wj.js";import{T as ct,d as Fe}from"./TextField-DL0nOe5P.js";import{c as De,V as lt,a as dt,d as Te}from"./index.esm-B2HhHynd.js";import{f as ge,s as ft}from"./currencyFormatter-DqHkUfNj.js";import{g as pt}from"./getCurrencySymbol-U33HH9zA.js";import{a as Oe}from"./index-CVGWP4XK.js";import{O as te}from"./order-direction-B5kfqJoW.js";import{i as he}from"./CurrencyIcon-BSh20PSx.js";import{O as J}from"./order-type-BEH08Hfo.js";import{a as mt}from"./helpers-BxXgrS-G.js";import{u as gt}from"./useRequireStatus-C5948B1u.js";import{b as ht}from"./index-DcvGW77o.js";import{c as yt,d as vt}from"./executed-orders.listener-GkgxCqGH.js";import{c as bt,d as St}from"./depth.listener-Bb9oU3qt.js";import{e as wt,s as Ct,b as xt}from"./index-DQUs1ZHf.js";import{b as Ie,s as Ft}from"./index-DamApG0r.js";import{s as Tt}from"./SegmentedTab-Bx0ApLVn.js";import{c as Ce}from"./capitalize-Crm3kySE.js";import{S as Ot}from"./index-DeSxTRGL.js";import{T as Et,a as Ee}from"./Tabs-nCopnh2s.js";import{a as Vt,b as Pt,N as Rt}from"./Names-CaXmBvXg.js";const Aa=e=>{const{ref:a,allowNegative:n,sx:i,...t}=e;return D.jsx(ut,{"data-lpignore":!0,getInputRef:a,customInput:ct,variant:"standard",allowNegative:n??!1,thousandSeparator:!0,valueIsNumericString:!0,sx:[()=>({[`& .${Fe.root}::before`]:{display:"none"},[`& .${Fe.root}::after`]:{display:"none"}}),...Array.isArray(i)?i:[i]],autoComplete:"off",...t})};var ce={},me=function(){return me=Object.assign||function(e){for(var a,n=1,i=arguments.length;n<i;n++)for(var t in a=arguments[n])Object.prototype.hasOwnProperty.call(a,t)&&(e[t]=a[t]);return e},me.apply(this,arguments)},Mt=function(){function e(a,n,i){var t=this;this.endVal=n,this.options=i,this.version="2.8.0",this.defaults={startVal:0,decimalPlaces:0,duration:2,useEasing:!0,useGrouping:!0,useIndianSeparators:!1,smartEasingThreshold:999,smartEasingAmount:333,separator:",",decimal:".",prefix:"",suffix:"",enableScrollSpy:!1,scrollSpyDelay:200,scrollSpyOnce:!1},this.finalEndVal=null,this.useEasing=!0,this.countDown=!1,this.error="",this.startVal=0,this.paused=!0,this.once=!1,this.count=function(u){t.startTime||(t.startTime=u);var p=u-t.startTime;t.remaining=t.duration-p,t.useEasing?t.countDown?t.frameVal=t.startVal-t.easingFn(p,0,t.startVal-t.endVal,t.duration):t.frameVal=t.easingFn(p,t.startVal,t.endVal-t.startVal,t.duration):t.frameVal=t.startVal+(t.endVal-t.startVal)*(p/t.duration);var l=t.countDown?t.frameVal<t.endVal:t.frameVal>t.endVal;t.frameVal=l?t.endVal:t.frameVal,t.frameVal=Number(t.frameVal.toFixed(t.options.decimalPlaces)),t.printValue(t.frameVal),p<t.duration?t.rAF=requestAnimationFrame(t.count):t.finalEndVal!==null?t.update(t.finalEndVal):t.options.onCompleteCallback&&t.options.onCompleteCallback()},this.formatNumber=function(u){var p,l,f,m,b=u<0?"-":"";p=Math.abs(u).toFixed(t.options.decimalPlaces);var x=(p+="").split(".");if(l=x[0],f=x.length>1?t.options.decimal+x[1]:"",t.options.useGrouping){m="";for(var U=3,k=0,M=0,w=l.length;M<w;++M)t.options.useIndianSeparators&&M===4&&(U=2,k=1),M!==0&&k%U==0&&(m=t.options.separator+m),k++,m=l[w-M-1]+m;l=m}return t.options.numerals&&t.options.numerals.length&&(l=l.replace(/[0-9]/g,function(O){return t.options.numerals[+O]}),f=f.replace(/[0-9]/g,function(O){return t.options.numerals[+O]})),b+t.options.prefix+l+f+t.options.suffix},this.easeOutExpo=function(u,p,l,f){return l*(1-Math.pow(2,-10*u/f))*1024/1023+p},this.options=me(me({},this.defaults),i),this.formattingFn=this.options.formattingFn?this.options.formattingFn:this.formatNumber,this.easingFn=this.options.easingFn?this.options.easingFn:this.easeOutExpo,this.startVal=this.validateValue(this.options.startVal),this.frameVal=this.startVal,this.endVal=this.validateValue(n),this.options.decimalPlaces=Math.max(this.options.decimalPlaces),this.resetDuration(),this.options.separator=String(this.options.separator),this.useEasing=this.options.useEasing,this.options.separator===""&&(this.options.useGrouping=!1),this.el=typeof a=="string"?document.getElementById(a):a,this.el?this.printValue(this.startVal):this.error="[CountUp] target is null or undefined",typeof window<"u"&&this.options.enableScrollSpy&&(this.error?console.error(this.error,a):(window.onScrollFns=window.onScrollFns||[],window.onScrollFns.push(function(){return t.handleScroll(t)}),window.onscroll=function(){window.onScrollFns.forEach(function(u){return u()})},this.handleScroll(this)))}return e.prototype.handleScroll=function(a){if(a&&window&&!a.once){var n=window.innerHeight+window.scrollY,i=a.el.getBoundingClientRect(),t=i.top+window.pageYOffset,u=i.top+i.height+window.pageYOffset;u<n&&u>window.scrollY&&a.paused?(a.paused=!1,setTimeout(function(){return a.start()},a.options.scrollSpyDelay),a.options.scrollSpyOnce&&(a.once=!0)):(window.scrollY>u||t>n)&&!a.paused&&a.reset()}},e.prototype.determineDirectionAndSmartEasing=function(){var a=this.finalEndVal?this.finalEndVal:this.endVal;this.countDown=this.startVal>a;var n=a-this.startVal;if(Math.abs(n)>this.options.smartEasingThreshold&&this.options.useEasing){this.finalEndVal=a;var i=this.countDown?1:-1;this.endVal=a+i*this.options.smartEasingAmount,this.duration=this.duration/2}else this.endVal=a,this.finalEndVal=null;this.finalEndVal!==null?this.useEasing=!1:this.useEasing=this.options.useEasing},e.prototype.start=function(a){this.error||(this.options.onStartCallback&&this.options.onStartCallback(),a&&(this.options.onCompleteCallback=a),this.duration>0?(this.determineDirectionAndSmartEasing(),this.paused=!1,this.rAF=requestAnimationFrame(this.count)):this.printValue(this.endVal))},e.prototype.pauseResume=function(){this.paused?(this.startTime=null,this.duration=this.remaining,this.startVal=this.frameVal,this.determineDirectionAndSmartEasing(),this.rAF=requestAnimationFrame(this.count)):cancelAnimationFrame(this.rAF),this.paused=!this.paused},e.prototype.reset=function(){cancelAnimationFrame(this.rAF),this.paused=!0,this.resetDuration(),this.startVal=this.validateValue(this.options.startVal),this.frameVal=this.startVal,this.printValue(this.startVal)},e.prototype.update=function(a){cancelAnimationFrame(this.rAF),this.startTime=null,this.endVal=this.validateValue(a),this.endVal!==this.frameVal&&(this.startVal=this.frameVal,this.finalEndVal==null&&this.resetDuration(),this.finalEndVal=null,this.determineDirectionAndSmartEasing(),this.rAF=requestAnimationFrame(this.count))},e.prototype.printValue=function(a){var n;if(this.el){var i=this.formattingFn(a);!((n=this.options.plugin)===null||n===void 0)&&n.render?this.options.plugin.render(this.el,i):this.el.tagName==="INPUT"?this.el.value=i:this.el.tagName==="text"||this.el.tagName==="tspan"?this.el.textContent=i:this.el.innerHTML=i}},e.prototype.ensureNumber=function(a){return typeof a=="number"&&!isNaN(a)},e.prototype.validateValue=function(a){var n=Number(a);return this.ensureNumber(n)?n:(this.error="[CountUp] invalid start or end value: ".concat(a),null)},e.prototype.resetDuration=function(){this.startTime=null,this.duration=1e3*Number(this.options.duration),this.remaining=this.duration},e}();const qt=Object.freeze(Object.defineProperty({__proto__:null,CountUp:Mt},Symbol.toStringTag,{value:"Module"})),At=_e(qt);var Ve;function kt(){if(Ve)return ce;Ve=1,Object.defineProperty(ce,"__esModule",{value:!0});var e=$e(),a=At;function n(s,r){var o=s==null?null:typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(o!=null){var c,g,S,P,h=[],E=!0,V=!1;try{if(S=(o=o.call(s)).next,r!==0)for(;!(E=(c=S.call(o)).done)&&(h.push(c.value),h.length!==r);E=!0);}catch(R){V=!0,g=R}finally{try{if(!E&&o.return!=null&&(P=o.return(),Object(P)!==P))return}finally{if(V)throw g}}return h}}function i(s,r){var o=Object.keys(s);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(s);r&&(c=c.filter(function(g){return Object.getOwnPropertyDescriptor(s,g).enumerable})),o.push.apply(o,c)}return o}function t(s){for(var r=1;r<arguments.length;r++){var o=arguments[r]!=null?arguments[r]:{};r%2?i(Object(o),!0).forEach(function(c){l(s,c,o[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(o)):i(Object(o)).forEach(function(c){Object.defineProperty(s,c,Object.getOwnPropertyDescriptor(o,c))})}return s}function u(s,r){if(typeof s!="object"||!s)return s;var o=s[Symbol.toPrimitive];if(o!==void 0){var c=o.call(s,r);if(typeof c!="object")return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(s)}function p(s){var r=u(s,"string");return typeof r=="symbol"?r:String(r)}function l(s,r,o){return r=p(r),r in s?Object.defineProperty(s,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):s[r]=o,s}function f(){return f=Object.assign?Object.assign.bind():function(s){for(var r=1;r<arguments.length;r++){var o=arguments[r];for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(s[c]=o[c])}return s},f.apply(this,arguments)}function m(s,r){if(s==null)return{};var o={},c=Object.keys(s),g,S;for(S=0;S<c.length;S++)g=c[S],!(r.indexOf(g)>=0)&&(o[g]=s[g]);return o}function b(s,r){if(s==null)return{};var o=m(s,r),c,g;if(Object.getOwnPropertySymbols){var S=Object.getOwnPropertySymbols(s);for(g=0;g<S.length;g++)c=S[g],!(r.indexOf(c)>=0)&&Object.prototype.propertyIsEnumerable.call(s,c)&&(o[c]=s[c])}return o}function x(s,r){return U(s)||n(s,r)||k(s,r)||w()}function U(s){if(Array.isArray(s))return s}function k(s,r){if(s){if(typeof s=="string")return M(s,r);var o=Object.prototype.toString.call(s).slice(8,-1);if(o==="Object"&&s.constructor&&(o=s.constructor.name),o==="Map"||o==="Set")return Array.from(s);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return M(s,r)}}function M(s,r){(r==null||r>s.length)&&(r=s.length);for(var o=0,c=new Array(r);o<r;o++)c[o]=s[o];return c}function w(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var O=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?e.useLayoutEffect:e.useEffect;function C(s){var r=e.useRef(s);return O(function(){r.current=s}),e.useCallback(function(){for(var o=arguments.length,c=new Array(o),g=0;g<o;g++)c[g]=arguments[g];return r.current.apply(void 0,c)},[])}var H=function(r,o){var c=o.decimal,g=o.decimals,S=o.duration,P=o.easingFn,h=o.end,E=o.formattingFn,V=o.numerals,R=o.prefix,A=o.separator,N=o.start,$=o.suffix,K=o.useEasing,I=o.useGrouping,v=o.useIndianSeparators,F=o.enableScrollSpy,j=o.scrollSpyDelay,Q=o.scrollSpyOnce,_=o.plugin;return new a.CountUp(r,h,{startVal:N,duration:S,decimal:c,decimalPlaces:g,easingFn:P,formattingFn:E,numerals:V,separator:A,prefix:R,suffix:$,plugin:_,useEasing:K,useIndianSeparators:v,useGrouping:I,enableScrollSpy:F,scrollSpyDelay:j,scrollSpyOnce:Q})},ae=["ref","startOnMount","enableReinitialize","delay","onEnd","onStart","onPauseResume","onReset","onUpdate"],z={decimal:".",separator:",",delay:null,prefix:"",suffix:"",duration:2,start:0,decimals:0,startOnMount:!0,enableReinitialize:!0,useEasing:!0,useGrouping:!0,useIndianSeparators:!1},ee=function(r){var o=Object.fromEntries(Object.entries(r).filter(function(Y){var ue=x(Y,2),fe=ue[1];return fe!==void 0})),c=e.useMemo(function(){return t(t({},z),o)},[r]),g=c.ref,S=c.startOnMount,P=c.enableReinitialize,h=c.delay,E=c.onEnd,V=c.onStart,R=c.onPauseResume,A=c.onReset,N=c.onUpdate,$=b(c,ae),K=e.useRef(),I=e.useRef(),v=e.useRef(!1),F=C(function(){return H(typeof g=="string"?g:g.current,$)}),j=C(function(Y){var ue=K.current;if(ue&&!Y)return ue;var fe=F();return K.current=fe,fe}),Q=C(function(){var Y=function(){return j(!0).start(function(){E==null||E({pauseResume:_,reset:W,start:X,update:ne})})};h&&h>0?I.current=setTimeout(Y,h*1e3):Y(),V==null||V({pauseResume:_,reset:W,update:ne})}),_=C(function(){j().pauseResume(),R==null||R({reset:W,start:X,update:ne})}),W=C(function(){j().el&&(I.current&&clearTimeout(I.current),j().reset(),A==null||A({pauseResume:_,start:X,update:ne}))}),ne=C(function(Y){j().update(Y),N==null||N({pauseResume:_,reset:W,start:X})}),X=C(function(){W(),Q()}),re=C(function(Y){S&&(Y&&W(),Q())});return e.useEffect(function(){v.current?P&&re(!0):(v.current=!0,re())},[P,v,re,h,r.start,r.suffix,r.prefix,r.duration,r.separator,r.decimals,r.decimal,r.formattingFn]),e.useEffect(function(){return function(){W()}},[W]),{start:X,pauseResume:_,reset:W,update:ne,getCountUp:j}},B=["className","redraw","containerProps","children","style"],L=function(r){var o=r.className,c=r.redraw,g=r.containerProps,S=r.children,P=r.style,h=b(r,B),E=e.useRef(null),V=e.useRef(!1),R=ee(t(t({},h),{},{ref:E,startOnMount:typeof S!="function"||r.delay===0,enableReinitialize:!1})),A=R.start,N=R.reset,$=R.update,K=R.pauseResume,I=R.getCountUp,v=C(function(){A()}),F=C(function(_){r.preserveValue||N(),$(_)}),j=C(function(){if(typeof r.children=="function"&&!(E.current instanceof Element)){console.error(`Couldn't find attached element to hook the CountUp instance into! Try to attach "containerRef" from the render prop to a an Element, eg. <span ref={containerRef} />.`);return}I()});e.useEffect(function(){j()},[j]),e.useEffect(function(){V.current&&F(r.end)},[r.end,F]);var Q=c&&r;return e.useEffect(function(){c&&V.current&&v()},[v,c,Q]),e.useEffect(function(){!c&&V.current&&v()},[v,c,r.start,r.suffix,r.prefix,r.duration,r.separator,r.decimals,r.decimal,r.className,r.formattingFn]),e.useEffect(function(){V.current=!0},[]),typeof S=="function"?S({countUpRef:E,start:A,reset:N,update:$,pauseResume:K,getCountUp:I}):e.createElement("span",f({className:o,ref:E,style:P},g),typeof r.start<"u"?I().formattingFn(r.start):"")};return ce.default=L,ce.useCountUp=ee,ce}var Dt=kt();const ka=Ke(Dt);var je=(e=>(e.goodTillCancel="goodTillCancel",e.immediateOrCancel="immediateOrCancel",e.fillOrKill="fillOrKill",e))(je||{});const ie={symbol:{base:q.KAU,quote:q.USD,symbolId:"KAU_USD"},orderType:J.market,direction:te.buy,triggerType:{type:je.goodTillCancel},input:{value:"",code:q.KAU},pay:{value:"0",code:q.USD},receive:{value:"0",code:q.KAU},rate:{value:"",code:q.USD},amount:{value:"0",code:q.KAU},total:{value:"0",code:q.USD},fee:{value:"0",code:q.KAU},feeRate:{percent:"0.0022",code:q.KAU},beforeFee:{value:"0",code:q.KAU},beforeFeeReceive:{value:"0",code:q.KAU},feeReceive:{value:"0",code:q.KAU}},It={trade:ie,precision:{ceil:()=>({value:"0",code:q.USD}),floor:()=>({value:"0",code:q.USD}),decimal:()=>8},loading:{depth:!0,executedOrders:!0},isLoading:!0},jt={onDirection:()=>{},onOrderType:()=>{},onChange:()=>{},onRate:()=>{},onFocus:()=>{},onTrigger:()=>{},onTriggerType:()=>{},clear:()=>{}},se=d.createContext(It),de=d.createContext(jt);Re.injectEndpoints({endpoints:e=>({getWarningFlags:e.query({queryFn:()=>({data:{marketMakerWarning:!1,timeMarketMakerWarning:!1}})}),createOrder:e.mutation({queryFn:({amount:a,direction:n,limitPrice:i,orderType:t,symbolId:u})=>({data:{amount:a,remaining:a,accountId:"",limitPrice:i,id:"28",direction:n,symbolId:u,status:We.partialFill,estimatedFee:10,orderType:t,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),metadata:{cancellationReason:""},jobId:"a008a4be-25f8-4318-a00c-b63db72b7250",globalTransactionId:"OT123456789"}})}),getTradeFee:e.query({queryFn:()=>({data:{rate:.0022}}),providesTags:["account-info"]}),getCustomFee:e.query({queryFn:async()=>({data:(await ze(async()=>{const{default:n}=await import("./mock-symbols-XbtdsFaM.js");return{default:n}},[])).default.map(({id:n,fee:i})=>({accountId:"sadf-dfsa",symbolId:n,rate:.0022,currency:i}))}),providesTags:["account-info"]})}),overrideExisting:Me.dataProvider==="mock"});const Ut=Re.injectEndpoints({endpoints:e=>({getWarningFlags:e.query({query:()=>({url:"exchange/admin/flags"})}),createOrder:e.mutation({query:a=>({method:"POST",url:"exchange/orders",body:a})}),getTradeFee:e.query({query:()=>({method:"GET",url:"exchange/fees/trade"}),providesTags:["account-info"]}),getCustomFee:e.query({query:()=>({method:"GET",url:"exchange/fees/account"}),providesTags:["account-info"]})}),overrideExisting:Me.dataProvider==="api"}),Bt=Ut,{useGetWarningFlagsQuery:Lt,useCreateOrderMutation:Nt,useGetTradeFeeQuery:_t,useGetCustomFeeQuery:$t}=Bt,Pe=e=>a=>{try{De().shape(e).validateSync(a)}catch(n){if(n instanceof lt)return{isValid:!1,message:n.message,errors:{[n.path??""]:n.message}}}return{isValid:!0,errors:{}}},Kt=e=>{var l,f;const a=new y(T(Ge)??0),n=((l=T(m=>Ie(m,e)))==null?void 0:l.quoteDecimals)??8,i=new y(((f=T(m=>wt(m,e)))==null?void 0:f.orderRange)??0),t=a.times(i),u=Number(t.plus(a).toFixed(n,y.roundDown));return{lowerBound:Number(a.minus(t).toFixed(n,y.roundDown)),upperBound:u}},le=()=>De().shape({value:Te().required(),code:Te().oneOf(Object.values(q)).required()}),oe={pay:le().required(),receive:le().required(),beforeFee:le().required(),fee:le().required(),rate:le().required(),trigger:dt().optional()},zt=(e=0,a)=>({name:"greaterThanZero",message:n=>a??`${Ce(n.path)} must be greater than ${e}`,test:n=>!!n.value&&new y(n.value).gt(e)}),ye=(e=0,a)=>({name:"greaterThanOrEqualToValue",message:n=>a??`${Ce(n.path)} must be greater than or equal to ${e}`,test:n=>!!n.value&&new y(n.value).gte(e)}),Wt=(e=0,a)=>({name:"lessThanOrEqualToValue",message:n=>a??`${Ce(n.path)} must be less than or equal to ${e}`,test:n=>!!n.value&&new y(n.value).lte(e)}),Gt=e=>{var U,k,M;const{formatMessage:a}=we(),n=((U=T(w=>ve(w,e.pay.code)))==null?void 0:U.available)??0,i=((k=T(w=>Oe(w,e.pay.code)))==null?void 0:k.minAmount)??.01,t=((M=T(w=>Oe(w,e.receive.code)))==null?void 0:M.minAmount)??.01,{lowerBound:u,upperBound:p}=Kt(e.symbol.symbolId),l=pt(e.symbol.quote),{bestPrice:f}=Ue(),m=e.direction===te.buy,b=d.useMemo(()=>{const w={...oe};return w.pay=oe.pay.test("availableBalance",a({id:"6aLrBP",defaultMessage:[{type:0,value:"Exceeds balance by "},{type:1,value:"amount"}]},{amount:ge({value:new y(e.pay.value).minus(n).toNumber(),code:e.pay.code},{appendCurrencyCode:he(e.pay.code)})}),O=>!!O.value&&new y(O.value).lte(n)),w},[a,e.pay.value,e.pay.code,n]),x=d.useMemo(()=>{const w={...oe};return w.pay=b.pay.test(ye(i,`Minimum trade amount ${ge({value:i,code:e.pay.code},{appendCurrencyCode:he(e.pay.code)})}`)),w.receive=b.receive.test(ye(t,`Minimum trade amount ${ge({value:t,code:e.receive.code},{appendCurrencyCode:he(e.receive.code)})}`)),e.orderType===J.limit?w.rate=oe.rate.test(ye(u,a({id:"Dw75ZH",defaultMessage:[{type:0,value:"Price can't be lower than "},{type:1,value:"quoteCurrency"},{type:1,value:"lowerBound"}]},{quoteCurrency:l,lowerBound:u.toString()}))).test(Wt(p,a({id:"WQ/d+G",defaultMessage:[{type:0,value:"Price can't be higher than "},{type:1,value:"quoteCurrency"},{type:1,value:"upperBound"}]},{quoteCurrency:l,upperBound:p.toString()}))):e.orderType!==J.stopLoss&&(w.rate=b.rate.test(zt())),(e.orderType===J.stopLimit||e.orderType===J.stopLoss)&&(m?w.trigger=oe.trigger.test("trigger",a({id:"e4Pjcg",defaultMessage:[{type:0,value:"Trigger must be higher than best Ask price"}]}),O=>!O||new y(O).gt(f.value)):w.trigger=oe.trigger.test("trigger",a({id:"ubT9Oc",defaultMessage:[{type:0,value:"Trigger must be lower than best Bid price"}]}),O=>!O||new y(O).lt(f.value))),w},[f.value,a,m,u,b.pay,b.rate,b.receive,i,l,t,e.orderType,e.pay.code,e.receive.code,p]);return{schema:oe,onChange:Pe(b),onSubmit:Pe(x)}},Se=e=>({...e,value:ft(e.value)}),Ht=(e,a,n)=>e.includes(a)||e.includes(n),Qt=(e,a,n,i)=>e===be.kycVerified||!Ht(a,n,i),Da=()=>{const{trade:e,precision:{decimal:a}}=d.use(se),{clear:n}=d.use(de),[i,t]=Nt(),u=Gt(e),p=T(xe(e.fee.code)),l=T(xe(e.symbol.quote)),[f,m]=d.useState(!1),[b,x]=d.useState(!1),[U,k]=d.useState(!1),M=gt();d.useEffect(()=>{m(!1)},[e]);const w=d.useMemo(()=>u.onChange(e),[e,u]),O=d.useMemo(()=>f?u.onSubmit(e):void 0,[f,e,u]),{formatMessage:C}=we(),H=T(He),ae=T(ht),{data:z}=Lt(),{base:ee,quote:B}=T(qe),L=d.useCallback(async({skipClear:r=!1,source:o})=>{const{amount:c,direction:g,symbol:S,orderType:P,rate:h,fee:E,trigger:V,triggerType:R}=e;if(!u.onSubmit(e).isValid)return m(!0);const A=Se(c),N=E.code===A.code?(g===te.buy?A.value.plus(E.value):A.value.minus(E.value)).round(a(A.code),y.roundDown):A.value,$={symbolId:S.symbolId,amount:N.toNumber(),direction:g,orderType:P,source:o,stopPrice:V?Number(V):void 0,timeInForce:R==null?void 0:R.type,...(P===J.limit||P===J.stopLimit)&&{limitPrice:Number(h.value)}},K=new y(E.value).times(p.askPrice).toNumber(),I=await mt(i($),C({id:"mJ5u49",defaultMessage:[{type:0,value:"Successfully placed order"}]}),C({id:"MavFes",defaultMessage:[{type:0,value:"Failed to place order"}]}));Qe.gtag("event","purchase",{transaction_id:I==null?void 0:I.id,value:K,currency:"USD",symbol:S.symbolId,items:[{item_name:S.symbolId,quantity:N.toNumber(),price:K}],valueUsd:N.times(l.askPrice).toNumber(),direction:g,timeInForce:$.timeInForce,orderType:P,source:o}),r||n()},[n,i,a,p.askPrice,C,l.askPrice,e,u]),s=d.useCallback(async({skipClear:r=!1,source:o})=>{H===be.pendingManualCheck?M({required:be.kycVerified})():Qt(H,ae,ee,B)?(e==null?void 0:e.orderType)===J.market&&z&&(z.timeMarketMakerWarning||z.marketMakerWarning)?k(!0):await L({skipClear:r,source:o}):x(!0)},[H,ae,ee,B,e==null?void 0:e.orderType,z,M,L]);return{onSubmit:L,handleFormSubmission:s,details:t,error:{isValid:new y(e.amount.value).gt(0)&&((O==null?void 0:O.isValid)??w.isValid),change:w.message,submit:O==null?void 0:O.message},popup:{verifyPopup:b,setVerifyPopup:x,marketPopup:U,setMarketPopup:k}}},Yt=(e,a,n)=>{var p;const i=new y(a);if(i.eq(0)||!n.length)return{value:new y(((p=n==null?void 0:n[0])==null?void 0:p.price)??0),code:e};const{totalCost:t,totalOrder:u}=n.reduce((l,{amount:f,price:m})=>{const b=l.remaining.gte(f)?new y(f):l.remaining,x={value:b.times(m)};return{remaining:l.remaining.minus(b),totalCost:l.totalCost.plus(x.value),totalOrder:l.totalOrder.plus(b)}},{remaining:i,totalCost:new y(0),totalOrder:new y(0)});return{value:t.div(u),code:e}},Zt=e=>{const{data:a,isLoading:n}=_t(),{data:i,isLoading:t}=$t(),u=T(Ct),p=T(xt);return{feeRate:d.useMemo(()=>{var m;if(!a||!i||n||t||u)return{percent:new y(.0022),code:e.quote};const f=i.find(({symbolId:b})=>b===e.symbolId);return{percent:new y((f==null?void 0:f.rate)??a.rate),code:(m=p[e.symbolId])==null?void 0:m.fee}},[a,i,n,t,u,p,e.symbolId,e.quote]),isLoading:n||t||u}},Jt=e=>{const{baseDecimals:a=8,quoteDecimals:n=8}=T(l=>Ie(l,e.symbolId))??{},i=T(Ft),t=d.useCallback(l=>l===e.base?a:n,[e.base,a,n]),u=d.useCallback((l,f=y.roundDown)=>({value:new y(l.value).round(t(l.code),f),code:l.code}),[t]),p=d.useCallback((l,f)=>({code:l.code,value:u(l,f).value.toFixed()}),[u]);return{round:p,floor:p,ceil:l=>p(l,y.roundUp),roundDecimal:u,decimal:t,isLoading:i}},Xt={"true,true,true":["C","R"],"true,true,false":["A","C"],"true,false,true":["R","C"],"true,false,false":["C","A"],"false,true,true":["R","C"],"false,true,false":["C","A"],"false,false,true":["C","R"],"false,false,false":["A","C"]};class ea{constructor(a,n){Z(this,"output");Z(this,"beforeFee",{value:new y(0),code:q.KAU});Z(this,"fee",{value:new y(0),code:q.KAU});Z(this,"isPay");Z(this,"isBuy");Z(this,"isFeeBase");Z(this,"takeFee",()=>({value:this.output.value.times(new y(1).minus(this.options.feeRate.percent)),code:this.output.code}));Z(this,"addFee",()=>({value:this.output.value.div(new y(1).minus(this.options.feeRate.percent)),code:this.output.code}));Z(this,"convert",(a=this.output)=>{const{rate:n,symbol:i}=this.options,t=a.code===i.quote;return{value:t?n.eq(0)?n:a.value.div(n):a.value.times(n),code:t?i.base:i.quote}});this.input=a,this.options=n;const{direction:i,codeDirection:t,feeRate:u,symbol:p}=this.options;this.output=this.input,this.isFeeBase=u.code===p.base,this.isBuy=i===te.buy,this.isPay=t.pay===this.input.code,Xt[`${this.isFeeBase},${this.isBuy},${this.isPay}`].forEach(f=>{f==="C"?this.output=this.convert():this.includeFee(f==="R")})}submit(){const a=this.fee.code===this.output.code;return{pay:this.isPay?this.input:this.output,receive:this.isPay?this.output:this.input,rate:{value:this.options.rate,code:this.options.symbol.quote},beforeFee:this.beforeFee,beforeFeeReceive:a?this.beforeFee:this.convert(this.beforeFee),fee:this.fee,feeReceive:a?this.fee:this.convert(this.fee)}}includeFee(a){this.beforeFee={...this.output},this.output=a?this.takeFee():this.addFee(),this.fee={value:this.beforeFee.value.minus(this.output.value).abs(),code:this.output.code}}}const Ia=({children:e})=>{const n=Ye().pathname.includes("pro"),i=T(Ze),t=T(qe),[u,p]=d.useState(ie.direction),[l,f]=d.useState(n?J.limit:ie.orderType),[m,b]=d.useState(ie.input),[x,U]=d.useState(),[k,M]=d.useState(ie.rate),[w,O]=d.useState(ie.triggerType),[C,H]=d.useState(),ae=d.useMemo(()=>u===te.buy?{pay:t.quote,receive:t.base}:{pay:t.base,receive:t.quote},[t,u]),{feeRate:z,isLoading:ee}=Zt(t),{floor:B,ceil:L,decimal:s,roundDecimal:r,isLoading:o}=Jt(t),c=T(Je),g=T(Xe),S=et(),P=d.useCallback((v,F={})=>{F.focus&&(H(v.code),b(v)),C===v.code&&b(v)},[C]),h=d.useMemo(()=>{const v=k.code===t.quote?t:{base:t.quote,quote:t.base},{pay:F,receive:j,beforeFee:Q,beforeFeeReceive:_,fee:W,feeReceive:ne}=new ea(Se(m),{codeDirection:ae,direction:u,feeRate:z,rate:Se(k).value,symbol:v}).submit(),X=r(F).value.eq(0)?B(F):L(F),re=B(j);return{symbol:t,direction:u,input:m,pay:X,receive:re,rate:k,amount:F.code===t.base?X:re,total:F.code===t.quote?X:re,fee:L(W),feeRate:{code:z.code,percent:z.percent.times(100).toString()},beforeFee:Q.code===F.code?L(Q):B(Q),beforeFeeReceive:_.code===F.code?L(_):B(_),feeReceive:L(ne)}},[k,t,m,ae,u,z,r,B,L]);d.useEffect(()=>{b(v=>({...v,code:t.base})),M(v=>({...v,code:t.quote}))},[t.base,t.quote]);const E=T(u===te.buy?tt:at),V=T(nt);d.useEffect(()=>{if(l===J.market&&!V){const v=u===te.buy?h.beforeFee.value:h.pay.value,F=Yt(t.quote,v,E);M(B(F))}},[l,t.quote,E,V,B,u,h.beforeFee.value,h.pay.value]),d.useEffect(()=>{const v=C===h.pay.code||C===h.receive.code;if(C&&m.code!==C&&h.pay.value!=="0"&&v){const F=m.code===h.pay.code?h.receive.code:h.pay.code,j=m.code===h.pay.code?h.receive.value:h.pay.value;P({code:F,value:j},{focus:!0})}},[C,m.code,P,h.pay.code,h.pay.value,h.receive.code,h.receive.value]),d.useEffect(()=>(S(bt()),S(yt()),()=>{S(St()),S(vt())}),[S]);const R=d.useMemo(()=>(i?ee:!1)||o||(i?g:!1),[ee,o,i,g]),A=d.useMemo(()=>({...h,orderType:l,focus:C,trigger:x,triggerType:w}),[C,l,h,x,w]),N=d.useMemo(()=>({trade:A,precision:{ceil:L,floor:B,decimal:s},loading:{depth:V,executedOrders:c},isLoading:R}),[A,L,B,s,V,c,R]),$=d.useCallback(v=>{H(void 0),O(v)},[]),K=d.useCallback(({skipRate:v}={})=>{v||M(F=>({...F,value:""})),b(F=>({...F,value:""})),U(void 0),H(void 0)},[]),I=d.useMemo(()=>({onDirection:p,onOrderType:f,onChange:P,onRate:M,onFocus:H,onTrigger:U,onTriggerType:$,clear:K}),[K,P,$]);return D.jsx(se,{value:N,children:D.jsx(de,{value:I,children:e})})},ta=()=>{const{trade:e}=d.use(se);return e},ja=()=>d.use(se),Ua=()=>d.use(de),Ue=()=>{const{trade:e,isLoading:a}=d.use(se),n=T(e.direction===te.buy?rt:ot);return{bestPrice:d.useMemo(()=>({value:n.toString(),code:e.symbol.quote}),[n,e.symbol.quote]),isLoading:a}},Be=()=>{const{trade:e,precision:{floor:a},isLoading:n}=d.use(se),{onChange:i}=d.use(de),t=T(f=>{var m;return((m=ve(f,e.pay.code))==null?void 0:m.available)??0}),u=T(f=>{var m;return((m=ve(f,e.receive.code))==null?void 0:m.available)??0}),p=d.useMemo(()=>({pay:a({value:new y(t),code:e.pay.code}),receive:a({value:new y(u),code:e.receive.code})}),[a,t,e.pay.code,e.receive.code,u]),l=d.useCallback(f=>i(a({value:new y(p.pay.value).times(f),code:e.pay.code}),{focus:!0}),[p.pay.value,i,a,e.pay.code]);return{balance:p,onBalancePercent:l,isLoading:n}},Ba=()=>{const{trade:e,precision:a,loading:n,isLoading:i}=d.use(se),t=d.use(de),{balance:u,onBalancePercent:p}=Be(),{bestPrice:l}=Ue();return{trade:e,balance:u,bestPrice:l,precision:a,events:{...t,onBalancePercent:p},loading:n,isLoading:i}},La=e=>{const{tabs:a=[25,50],sx:n,isLoading:i=!1,disabled:t=!1}=e,[u,p]=d.useState(),{onBalancePercent:l}=Be(),{pay:f}=ta(),m=d.useMemo(()=>f.value,[u]),b=x=>{p(U=>x!==U?x:void 0),l(x)};return d.useEffect(()=>{new y(m).eq(f.value)||p(void 0)},[f.value,m]),D.jsx(Ot,{variant:"node",isLoading:i,width:"inherit",children:D.jsxs(Et,{sx:n??Tt({tab:{root:{width:"48px"}},tabs:{root:{width:"fit-content"}}}),value:u??!1,"data-cy":"percentage-tabs",children:[a.map(x=>D.jsx(Ee,{label:D.jsx(pe,{id:"kggwrj",defaultMessage:[{type:1,value:"value"},{type:0,value:"%"}],values:{value:x}}),value:(x/100).toFixed(2),onClick:()=>b((x/100).toFixed(2)),disableRipple:!0,disabled:t},x)),D.jsx(Ee,{label:D.jsx(pe,{id:"kkjl2v",defaultMessage:[{type:0,value:"Max"}]}),value:"1",onClick:()=>b("1"),disableRipple:!0,disabled:t},"Max")]})})},Na=G("form")`
  display: flex;
  flex-direction: column;
  padding: 16px 16px 32px;
  height: 100%;
`,_a=G(Ae)`
  margin-top: 24px;
  margin-bottom: 12px;
  justify-content: space-between;

  .MuiChip-root {
    width: auto;
  }
`,$a=G(st)`
  gap: 4px;
  position: relative;
`,Ka=G(ke)`
  align-self: center;
`,za=G(Ae)`
  justify-content: space-between;
  margin-top: 8px;
`,Wa=G(it)`
  color: ${({theme:e})=>e.palette.designColors.interactive.primary.default};
  cursor: pointer;
`;var aa=(e=>(e[e.Trade=0]="Trade",e[e.Info=1]="Info",e[e.MarketPrice=2]="MarketPrice",e[e.OrderConfirmation=3]="OrderConfirmation",e[e.OrderType=4]="OrderType",e[e.CurrencySelect=5]="CurrencySelect",e))(aa||{});const Ga={padding:"10px 16px",".MuiAlert-message":{padding:0}},na=G("div")`
  display: flex;
  flex-direction: column;
  padding: 16px;
`,ra=G(Rt)`
  align-self: center;
  margin-bottom: 24px;
`,oa=G("span")`
  margin-bottom: 21px;
  font-size: 21px;
  line-height: 30px;
  letter-spacing: -0.2px;
  text-align: center;
  font-family: ${({theme:e})=>e.typography.fonts.bold};
  color: ${({theme:e})=>e.palette.designColors.text.default};
`,sa=G("span")`
  margin-bottom: 12px;
  font-size: 16px;
  line-height: 24px;
  text-align: center;
  font-family: ${({theme:e})=>e.typography.fonts.medium};
  color: ${({theme:e})=>e.palette.designColors.text.tertiary};
`,ia=G(ke)`
  margin-top: 20px;
  align-self: center;
`,ua=e=>{const{formatMessage:a}=we();return e.marketMakerWarning?a({id:"FRK5qo",defaultMessage:[{type:0,value:"Our liquidity providers are re-calibrating the prices, this usually takes around 10 minutes. We strongly advise placing limit orders only, as market orders could fill at an unfavourable price due to volatility during this period."}]}):a({id:"XqGRx8",defaultMessage:[{type:0,value:"We strongly advise placing limit orders only, as market orders could fill at an unfavourable price due the volatility during this period."}]})},Ha=e=>{const{onSubmit:a,flags:n}=e,i=ua(n);return D.jsxs(na,{children:[D.jsx(ra,{name:Pt.exchangeMaintenance,size:Vt.oneTwenty}),D.jsx(oa,{children:D.jsx(pe,{id:"TPTHca",defaultMessage:[{type:0,value:"Please note:"}]})}),D.jsx(sa,{children:i}),D.jsx(ia,{size:"large",onClick:a,"data-cy":"admin-warn-okay-btn",children:D.jsx(pe,{id:"gZlFBP",defaultMessage:[{type:0,value:"Okay"}]})})]})};var ca=(e=>(e.KmsHome="KmsHome",e.KmsExchange="KmsExchange",e))(ca||{});export{Ha as A,Wa as B,ka as C,za as I,Aa as N,ca as O,_a as P,Ka as S,je as T,Ua as a,Ue as b,ta as c,Be as d,La as e,Da as f,Lt as g,Ga as h,Ia as i,Ba as j,Na as k,aa as l,$a as m,Kt as n,ja as u};
